<!DOCTYPE html>
<html>
  <head>
    <title>Luna SDK -- Cobalt</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Streaming Synthesis :: Luna SDK -- Cobalt</title>
<link rel="shortcut icon" href="/sdk-luna/images/favicon.ico" type="image/x-icon" />
<link href="/sdk-luna/css/nucleus.css" rel="stylesheet">
<link href="/sdk-luna/css/font-awesome.min.css" rel="stylesheet">
<link href="/sdk-luna/css/hybrid.css" rel="stylesheet">
<link href="/sdk-luna/css/featherlight.min.css" rel="stylesheet">
<link href="/sdk-luna/css/auto-complete.css" rel="stylesheet">
<link href="/sdk-luna/theme-original/style.css" rel="stylesheet">

  <link href="/sdk-luna/theme-original/variant-blue.css" rel="stylesheet">

<link rel="stylesheet" href="/sdk-luna/css/bootstrap.min.css">
<script src="/sdk-luna/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link href="/sdk-luna/css/tabs.css" rel="stylesheet" type="text/css">
<script src="/sdk-luna/js/tabs.js"></script>


    
  </head>
  <body data-url="/sdk-luna/using-luna-sdk/streaming/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="showVisitedLinks">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <p><img src="/sdk-luna/images/logo-white.png" alt="Cobalt's SDK Documentation" /></p>

<p>Luna SDK &ndash; Cobalt</p>

  


    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="/sdk-luna/js/lunr.min.js"></script>
		<script type="text/javascript" src="/sdk-luna/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "https:\/\/cobaltspeech.github.io\/sdk-luna";
        
		</script>
		<script type="text/javascript" src="/sdk-luna/js/search.js"></script>
  </div>

      <ul class="topics">
            <li data-nav-id="/sdk-luna/" class="dd-item">
            <a href="/sdk-luna/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/sdk-luna/getting-started/" class="dd-item
        ">
      <div>
      <a href="/sdk-luna/getting-started/">Getting Started</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/sdk-luna/using-luna-sdk/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/sdk-luna/using-luna-sdk/">Using Luna SDK</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/sdk-luna/using-luna-sdk/include/" class="dd-item">
        <div>
          <a href="/sdk-luna/using-luna-sdk/include/">
            Including the SDK
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-luna/using-luna-sdk/errors/" class="dd-item">
        <div>
          <a href="/sdk-luna/using-luna-sdk/errors/">
            Error Handling
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-luna/using-luna-sdk/connecting/" class="dd-item">
        <div>
          <a href="/sdk-luna/using-luna-sdk/connecting/">
            Connecting to the Server
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-luna/using-luna-sdk/synthesis-config/" class="dd-item">
        <div>
          <a href="/sdk-luna/using-luna-sdk/synthesis-config/">
            Synthesis Configuration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-luna/using-luna-sdk/batch/" class="dd-item">
        <div>
          <a href="/sdk-luna/using-luna-sdk/batch/">
            Batch Synthesis
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-luna/using-luna-sdk/streaming/" class="dd-item active">
        <div>
          <a href="/sdk-luna/using-luna-sdk/streaming/">
            Streaming Synthesis
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/sdk-luna/protobuf/" class="dd-item
        ">
      <div>
      <a href="/sdk-luna/protobuf/">Luna API Reference</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>



        <section id="shortcuts">
                <li class="" role=""><h3>More</h3><a href="https://github.com/cobaltspeech/sdk-luna" target="_blank" rel="noopener"><i class='fa fa-github'></i> <label>Github repo</label></a></li>
                <li class="" role=""><a href="https://www.cobaltspeech.com/contact" target="_blank" rel="noopener"><i class='fa fa-bookmark'></i> <label>Contact us</label></a></li>
        </section>
            <a id="clear-history" class="" href="#" data-clear-history-toggle=""><i class="fa  fa-history"></i> Clear History</a>

    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        







 <a href='/sdk-luna/'>Luna SDK Documentation</a> > <a href='/sdk-luna/using-luna-sdk/'>Using Luna SDK</a> > Streaming Synthesis

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#example">Example</a></li>
</ul></li>
</ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Streaming Synthesis</h1>
  



    
    
    
    

<p>Unlike <a href="../batch">batch synthesis</a>, streaming synthesis begins to return the
generated audio data to the client as soon as it is ready, sending multiple
data packets until synthesis has completed. While this method is slightly
more complex than batch synthesis, it brings the following benefits:</p>

<ul>
<li>Faster response time - a client may begin to use data as soon as it receives.
This allows a client to begin audio playback even before synthesis is
complete.</li>
<li>Smaller data packet size - because the audio is sent in multiple messages over
the gRPC stream, each packet will carry less data than the batch method.

<ul>
<li>This makes it possible to submit larger sentences to Luna without
running out of memory.</li>
<li>Optionally, a <a href="../synthesis-config/#buffer-size-optional">buffer size</a>
may be specified to give more control over the amount of data transmitted
over the network connection at a time.</li>
</ul></li>
</ul>

<p>Once generated, it is the client codeâ€™s responsibility to handle the returned
audio, whether it sends it to an output device (e.g., speakers), saves it to a
file, or simply discards it.</p>

<h2 id="example">Example</h2>

<p>Assuming the synthesis configuration has been
<a href="../synthesis-config#example">set up previously</a>, here is an example
showing how to use the streaming synthesis method:</p>

<div class='code-tabs'>
  <ul class="nav-tabs"></ul>
  <div class="tab-content">

<div class="tab-pane" title="Go">
  <div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#999;font-style:italic">// Create the synthesis stream
</span><span style="color:#999;font-style:italic"></span>request := &amp;lunapb.SynthesizeRequest{
    Config: synthConfig,
    Text:   <span style="color:#ed9d13">&#34;this is an even better sentence&#34;</span>,
}

stream, err := client.<span style="color:#447fcf">SynthesizeStream</span>(context.<span style="color:#447fcf">Background</span>(), request)

<span style="color:#999;font-style:italic">// Wait for audio data from the server until the stream is closed, which
</span><span style="color:#999;font-style:italic">// will happen when synthesis is complete.
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">for</span> {
    <span style="color:#999;font-style:italic">// Get the next response from the server
</span><span style="color:#999;font-style:italic"></span>   response, err := stream.<span style="color:#447fcf">Recv</span>()

    <span style="color:#999;font-style:italic">// This indicates the stream has finished.
</span><span style="color:#999;font-style:italic"></span>   <span style="color:#6ab825;font-weight:bold">if</span> err == io.EOF {
        <span style="color:#6ab825;font-weight:bold">break</span>
    }
    <span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
        <span style="color:#6ab825;font-weight:bold">return</span> err
    }

    <span style="color:#999;font-style:italic">// Do something interesting with the audio
</span><span style="color:#999;font-style:italic"></span>   fmt.<span style="color:#447fcf">Printf</span>(<span style="color:#ed9d13">&#34;Received %v bytes of audio.\n&#34;</span>, <span style="color:#24909d">len</span>(response.Audio))
}

fmt.<span style="color:#447fcf">Printf</span>(<span style="color:#ed9d13">&#34;Synthesis complete.\n&#34;</span>)</code></pre></div>
</div>

<div class="tab-pane" title="Python">
  <div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Create the synthesis stream</span>
text = <span style="color:#ed9d13">&#34;this is an even better sentence&#34;</span>
request = SynthesizeRequest(config=synth_config, text=text)
stream = client.SynthesizeStream(request)

<span style="color:#999;font-style:italic"># Wait for audio data from the server until the stream is closed, which</span>
<span style="color:#999;font-style:italic"># will happen when synthesis is complete.</span>
<span style="color:#6ab825;font-weight:bold">for</span> response <span style="color:#6ab825;font-weight:bold">in</span> stream:
    <span style="color:#999;font-style:italic"># Do something interesting with the audio</span>
    <span style="color:#6ab825;font-weight:bold">print</span>(<span style="color:#ed9d13">&#34;Received {} bytes of audio.&#34;</span>.format(<span style="color:#24909d">len</span>(response.audio)))

<span style="color:#6ab825;font-weight:bold">print</span>(<span style="color:#ed9d13">&#34;Synthesis complete.&#34;</span>)</code></pre></div>
</div>

<div class="tab-pane" title="C&#43;&#43;">
  <div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#999;font-style:italic">// Create the synthesis stream
</span><span style="color:#999;font-style:italic"></span>std::string text = <span style="color:#ed9d13">&#34;this is an even better sentence&#34;</span>;
LunaSynthesizerStream stream = client.synthesizeStream(synthConfig, text);

<span style="color:#999;font-style:italic">// Wait for audio data from the server until the stream is closed, which
</span><span style="color:#999;font-style:italic">// will happen when synthesis is complete.
</span><span style="color:#999;font-style:italic"></span>ByteVector audio;
<span style="color:#6ab825;font-weight:bold">while</span>(stream.receiveAudio(audio))
{
    <span style="color:#999;font-style:italic">// Do something interesting with the audio
</span><span style="color:#999;font-style:italic"></span>    std::cout &lt;&lt; <span style="color:#ed9d13">&#34;Received &#34;</span> &lt;&lt; audio.size() &lt;&lt; <span style="color:#ed9d13">&#34; bytes of audio.&#34;</span> &lt;&lt; std::endl;
}

stream.close();
std::cout &lt;&lt; <span style="color:#ed9d13">&#34;Synthesis complete.&#34;</span> &lt;&lt; std::endl;
</code></pre></div>
</div>

<p></div>
</div></p>


    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/sdk-luna/using-luna-sdk/batch/" title="Batch Synthesis"> <i class="fa fa-chevron-left"></i><label>Batch Synthesis</label></a>
    <a class="nav nav-next" href="/sdk-luna/protobuf/" title="Luna API Reference" style="margin-right: 0px;"><label>Luna API Reference</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/sdk-luna/js/clipboard.min.js"></script>
<script src="/sdk-luna/js/featherlight.min.js"></script>
<script src="/sdk-luna/js/html5shiv-printshiv.min.js"></script>

<script src="/sdk-luna/js/modernizr.custom.71422.js"></script>
<script src="/sdk-luna/js/docdock.js"></script>
<script src="/sdk-luna/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>